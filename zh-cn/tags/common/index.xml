<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>common on biubiobiu's Blog</title><link>https://biubiobiu.github.io/zh-cn/tags/common/</link><description>Recent content in common on biubiobiu's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>Everything is mine</copyright><lastBuildDate>Tue, 01 Aug 2023 06:00:20 +0800</lastBuildDate><atom:link href="https://biubiobiu.github.io/zh-cn/tags/common/index.xml" rel="self" type="application/rss+xml"/><item><title>常用操作</title><link>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0030_hive_common/</link><pubDate>Tue, 01 Aug 2023 06:00:20 +0800</pubDate><guid>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0030_hive_common/</guid><description>常用功能 1、获取当前时间 from_unixtime(unix_timestamp(),&amp;#39;yyyy-MM-dd HH:mm:ss&amp;#39;) 2、多行合并为一行 select gid, concat_ws(&amp;#39;,&amp;#39;,collect_set(url)) from table group by gid; 3、一行拆多列 -- 1列 select gid, url from table lateral view explode(split(url_list, &amp;#39;,&amp;#39;))t as url -- 2列 select gid, url, url_flag from table lateral view posexplode(split(url_list, &amp;#39;,&amp;#39;))t1 as url_index, url lateral view posexplode(split(url_flag_list, &amp;#39;,&amp;#39;))t2 as url_flag_index, url_flag where url_index = url_flag_index; 4、添加行号 如果单纯想添加一个自增的行号，没有顺序要去的话，over（）里面可以空着
Select row_number() over() as rownum From table 5、窗函数 SELECT RANK () over (PARTITION BY SUBJECT ORDER BY score DESC) AS RANK, DENSE_RANK () over (PARTITION BY SUBJECT ORDER BY score DESC) AS DENSE_RANK, ROW_NUMBER () over (PARTITION BY SUBJECT ORDER BY score DESC) AS ROW_NUMBER FROM table; 6、条件语句 【nvl】</description></item></channel></rss>