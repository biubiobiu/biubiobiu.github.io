<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hive on biubiobiu's Blog</title><link>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/</link><description>Recent content in Hive on biubiobiu's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>Everything is mine</copyright><lastBuildDate>Tue, 01 Aug 2023 06:00:20 +0800</lastBuildDate><atom:link href="https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/index.xml" rel="self" type="application/rss+xml"/><item><title>创建库/表</title><link>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0010_hive_build/</link><pubDate>Tue, 01 Aug 2023 06:00:20 +0800</pubDate><guid>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0010_hive_build/</guid><description>一、数据库操作 1、创建数据库 功能 操作 查看数据库 show databases; 使用like关键字模糊匹配，显示包含db_前缀的数据库名称 show databases like &amp;lsquo;db_*'; 使用数据库 create database dbname; 创建数据库 create database dbname; 通过location指定数据库路径 create database dbname location &amp;lsquo;path路径&amp;rsquo;; 给数据库添加描述信息 create database dbname comment &amp;lsquo;dbname描述信息&amp;rsquo;; 删除数据库 删除数据库，这种删除，需要将数据库中的表全部删除，才能删除数据库 drop database dbname; 或者 drop database if exists dbname; cascade 强制删除 drop database dbname cascade; 查看数据库的详细描述 desc database dbname; destribe database dbname; 二、表操作 功能 操作 创建表 CREATE TABLE 表名 删除表 drop table if exists 表名 添加列 alter table 表名 add columns (列名 string comment &amp;lsquo;解释&amp;rsquo;) 修改字段类型 alter table 表名 change column 原字段名称 现字段名称 数据类型</description></item><item><title>常用操作</title><link>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0030_hive_common/</link><pubDate>Tue, 01 Aug 2023 06:00:20 +0800</pubDate><guid>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0030_hive_common/</guid><description>常用功能 1、获取当前时间 from_unixtime(unix_timestamp(),&amp;#39;yyyy-MM-dd HH:mm:ss&amp;#39;) 2、多行合并为一行 select gid, concat_ws(&amp;#39;,&amp;#39;,collect_set(url)) from table group by gid; 3、一行拆多列 -- 1列 select gid, url from table lateral view explode(split(url_list, &amp;#39;,&amp;#39;))t as url -- 2列 select gid, url, url_flag from table lateral view posexplode(split(url_list, &amp;#39;,&amp;#39;))t1 as url_index, url lateral view posexplode(split(url_flag_list, &amp;#39;,&amp;#39;))t2 as url_flag_index, url_flag where url_index = url_flag_index; 4、添加行号 如果单纯想添加一个自增的行号，没有顺序要去的话，over（）里面可以空着
Select row_number() over() as rownum From table 5、窗函数 SELECT RANK () over (PARTITION BY SUBJECT ORDER BY score DESC) AS RANK, DENSE_RANK () over (PARTITION BY SUBJECT ORDER BY score DESC) AS DENSE_RANK, ROW_NUMBER () over (PARTITION BY SUBJECT ORDER BY score DESC) AS ROW_NUMBER FROM table; 6、条件语句 【nvl】</description></item><item><title>常见函数</title><link>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0020_hive_func/</link><pubDate>Tue, 01 Aug 2023 06:00:20 +0800</pubDate><guid>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0020_hive_func/</guid><description>1、数学计算 函数 说明 round(double d) &amp;ndash;返回double型d的近似值（四舍五入），返回bigint型； round(double d,int n) &amp;ndash;返回保留double型d的n位小数double型近似值（四舍五入）； floor(double d) &amp;ndash;返回&amp;lt;=d的最大bigint值； ceil(double d) &amp;ndash;返回&amp;gt;=d的最小bigint 值； ceiling(double d) &amp;ndash;返回&amp;gt;=d的最小bigint 值； rand() &amp;ndash;每行返回一个double型随机数； rand(int seed) &amp;ndash;每行返回一个double型随机数，整数seed是随机因子； exp(double d) &amp;ndash;返回e的 d幂次方，返回double型； ln(double d) &amp;ndash;以自然数为底d的对数，返回double型； log10(double d) &amp;ndash;以10为底d的对数，返回double型； log2(double d) &amp;ndash;以2为底d的对数，返回double型； log(double base,double d) &amp;ndash;以base为底d的对数，返回double型； pow(double d,double p) &amp;ndash;d的p次幂，返回double型； power(double d,double p) &amp;ndash;d的p次幂，返回double型； sqrt(double d) &amp;ndash;d的平方根，返回double型； bin(bigint i) &amp;ndash;二进制i的string类型； hex(bigint i) &amp;ndash;十六进制i的string类型； hex(string str) &amp;ndash;计算十六进制表达的str值； unhex(string i) &amp;ndash;hex(string str)的逆方法； conv(bigint num,int from_base,int to_base) &amp;ndash;将bigint类型的num从from_base进制转换成to_base进制，返回string类型； conv(string num,int from_base,int to_base) &amp;ndash;将string类型的num从from_base进制转换成to_base进制，返回string类型； abs(double d) &amp;ndash;计算double型d 的绝对值，返回double型； pmod(int i1,int i2) &amp;ndash;int型i1对 int型 i2取模，结果为int型； pmod(double d1,double d2) &amp;ndash;double型i1对double型 i2取模，结果为double型； sin(double d) &amp;ndash;返回d的正弦值，结果为double型； asin(double d) &amp;ndash;返回d的反正弦值，结果为double型； cos(double d) &amp;ndash;返回d 的余弦值，结果为double型； acos(double d) &amp;ndash;返回d的反余弦值，结果为double型； tan(double d) &amp;ndash;返回d的正切值，结果为double型； atan(double d) &amp;ndash;返回d的反正切值，结果为double型； degrees(double d) &amp;ndash;将弧度值d转换成角度值，结果为double型； radians(double d) &amp;ndash;将角度值d转换成弧度值，结果为double型； positive(int i) &amp;ndash;等价有效表达式是+i,返回i，结果为int型； positive(double d) &amp;ndash;等价有效表达式是+d，返回d,结果为double型； negative(int i) &amp;ndash;等价有效表达式是-i，返回i的负数，结果为int型； negative(double d) &amp;ndash;等价有效表达式是-i，返回d的负数，结果为double型； sign(double d) &amp;ndash;如果d是正数的话，则返回float型1.</description></item><item><title>数据类型</title><link>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0040_hive_datatype/</link><pubDate>Tue, 01 Aug 2023 06:00:20 +0800</pubDate><guid>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0040_hive_datatype/</guid><description>一、数组array 【语法】：
array(val1, val2, val3, ...) 【建表】
create table temp.array_demo( meiti array&amp;lt;string&amp;gt; comment &amp;#39;&amp;#39; ) row format delimited fields terminated by &amp;#39;\t&amp;#39; -- (字段与字段之间的分隔符) lines terminated by &amp;#39;\n&amp;#39; () collection items terminated by &amp;#39;,&amp;#39; -- (必须使用, 一个字段中各个item的分割符) lacation &amp;#39;hdfs 路径&amp;#39; 【查询方法和函数】
-- 在字段类型为array中查找是否包含某元素 array_contains() -- 数组名[index]：查询 二、map 函数 说明 size(Map) map的长度 map_keys(Map) map中的所有key，返回array map_values(Map) map 中所有的value，返回array 【构建Map】 组装数据：to_json, str_to_map str_to_map(concat_ws(&amp;quot;,&amp;quot;, collect_set(concat_ws(':', date_key, price_value)))) 【构建Map】 聚合：combine；聚合去重：combine_unique combine(map1, map2, map3, &amp;hellip;) 【构建Map】 hive 自带方法 map(&amp;ldquo;key1&amp;rdquo;, value1, &amp;ldquo;key2&amp;rdquo;, value2) named_struct(&amp;ldquo;cnt&amp;rdquo;, 100, &amp;ldquo;uds&amp;rdquo;, array(2, 3, 4))</description></item><item><title>正则匹配</title><link>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0050_hive_regular/</link><pubDate>Tue, 01 Aug 2023 06:00:20 +0800</pubDate><guid>https://biubiobiu.github.io/zh-cn/posts/00035_programming_language/0070_hive/0020_hive/0050_hive_regular/</guid><description/></item></channel></rss>